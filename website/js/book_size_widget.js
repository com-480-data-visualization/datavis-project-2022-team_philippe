class BookSizeClass {
  constructor(svg_amim_class, svg_anim_id) {
    const svg = d3.selectAll("." + svg_amim_class);

    const background_color = '#aa767c';

    const min_height = 110; // in page coordinates (y inversed)
    const max_height = 130;
    const filled_percentage = d3.scaleLinear().domain([0, 100]).range([min_height, max_height]);

    const book = svg
      .append("g")
      .attr("transform", "translate(250 205.47)")
      .style("cursor", "pointer")
      .attr("class", "animation_book");

    const book_borders = book
      .append("path")
      .attr("d","M206.316 85.874l-81.867 0c-6.641,2.4115 -13.1238,3.5974 -19.4488,3.5974 -6.325,0 -12.8474,-1.1859 -19.5674,-3.5974l-81.7484 0 0 -4.9808 6.3647 -8.9339 0 -39.0162 29.6475 -27.1964c4.6251,1.0673 9.5265,1.6206 14.7052,1.6206 3.3995,0 8.0245,-1.1463 13.8751,-3.4392 5.8898,-2.2532 11.5822,-3.3994 17.1559,-3.3994 9.4872,0 16.0097,3.5969 19.5674,10.752 3.3994,-7.1551 9.8827,-10.752 19.4488,-10.752 5.5738,0 11.2661,1.1462 17.1559,3.3994 5.8506,2.2929 10.4757,3.4392 13.8751,3.4392 5.1787,0 10.1198,-0.5533 14.8238,-1.6206l29.529 27.1964 0 39.0162 6.4832 8.9339 0 4.9808zm-10.7525 -52.5752l-26.7617 -25.2597c-3.7552,0.7909 -8.1038,1.1859 -12.966,1.1859 -4.7829,0 -10.0008,-1.1462 -15.6143,-3.3597 -5.6526,-2.2533 -10.9103,-3.3602 -15.7725,-3.3602 -8.6571,0 -14.7052,3.0833 -18.184,9.25l1.0673 25.0225c3.7557,-5.9692 10.041,-8.9339 18.8559,-8.9339 7.5109,0 15.4167,1.3839 23.7974,4.1903 8.3802,2.7673 15.1399,4.1507 20.3182,4.1507 6.9576,0 15.3775,-0.9487 25.2597,-2.8859zm0 41.7046l0 -38.9373c-3.8738,0.7905 -12.2148,1.6206 -25.0225,2.5693 -5.3366,0.0794 -12.2938,-1.2648 -20.9112,-3.9527 -8.5781,-2.6884 -16.4051,-4.0321 -23.4416,-4.0321 -9.5661,0 -16.6419,4.2296 -21.188,12.7284 -4.5461,-8.4988 -11.6218,-12.7284 -21.188,-12.7284 -7.0365,0 -14.8634,1.3437 -23.4416,4.0321 -8.6174,2.6879 -15.5746,4.0321 -20.9111,3.9527 -8.42,-0.0789 -16.8006,-0.9487 -25.1412,-2.5693l0 38.9373 72.9723 0c3.7556,-5.2577 9.6851,-7.9063 17.7096,-7.9063 8.0245,0 13.9148,2.6486 17.5911,7.9063l72.9722 0zm-91.8281 -63.2483c-3.5577,-6.1667 -9.6455,-9.25 -18.3026,-9.25 -4.8622,0 -10.0802,1.1069 -15.6936,3.3602 -5.613,2.2135 -10.7917,3.3597 -15.5745,3.3597 -4.8622,0 -9.2109,-0.395 -12.9661,-1.1859l-26.8803 25.2597c9.9616,1.9372 18.4207,2.8859 25.3783,2.8859 5.1783,0 11.938,-1.3834 20.3182,-4.1507 8.3807,-2.8064 16.2866,-4.1903 23.7974,-4.1903 8.8149,0 15.1002,2.9647 18.8559,8.9339l1.0673 -25.0225z")
      .attr("fill", "#000000")
      .attr("transform", "scale(1, 1)");


    const wine = book
    .append("rect")
    .attr("x", 42.871)
    .attr("y", filled_percentage(0))
    .attr("width", 18.672)
    .attr("height", 0)
    .attr("fill", "#852369")
    .style("paint-order", "normal")
    .attr("class", "basicsWine");

/*
    const borders = book
      .append("path")
      .attr("d","M206.316 85.874l-81.867 0c-6.641,2.4115 -13.1238,3.5974 -19.4488,3.5974 -6.325,0 -12.8474,-1.1859 -19.5674,-3.5974l-81.7484 0 0 -4.9808 6.3647 -8.9339 0 -39.0162 29.6475 -27.1964c4.6251,1.0673 9.5265,1.6206 14.7052,1.6206 3.3995,0 8.0245,-1.1463 13.8751,-3.4392 5.8898,-2.2532 11.5822,-3.3994 17.1559,-3.3994 9.4872,0 16.0097,3.5969 19.5674,10.752 3.3994,-7.1551 9.8827,-10.752 19.4488,-10.752 5.5738,0 11.2661,1.1462 17.1559,3.3994 5.8506,2.2929 10.4757,3.4392 13.8751,3.4392 5.1787,0 10.1198,-0.5533 14.8238,-1.6206l29.529 27.1964 0 39.0162 6.4832 8.9339 0 4.9808z")
      .attr("fill", "#050000");

    const right_page = book
      .append("path")
      .attr("d","m-10.7525 -52.5752l-26.7617 -25.2597c-3.7552,0.7909 -8.1038,1.1859 -12.966,1.1859 -4.7829,0 -10.0008,-1.1462 -15.6143,-3.3597 -5.6526,-2.2533 -10.9103,-3.3602 -15.7725,-3.3602 -8.6571,0 -14.7052,3.0833 -18.184,9.25l1.0673 25.0225c3.7557,-5.9692 10.041,-8.9339 18.8559,-8.9339 7.5109,0 15.4167,1.3839 23.7974,4.1903 8.3802,2.7673 15.1399,4.1507 20.3182,4.1507 6.9576,0 15.3775,-0.9487 25.2597,-2.8859z")
      .attr("fill", "#123456");

    const siding_pages = book
      .append("path")
      .attr("d","m0 41.7046l0 -38.9373c-3.8738,0.7905 -12.2148,1.6206 -25.0225,2.5693 -5.3366,0.0794 -12.2938,-1.2648 -20.9112,-3.9527 -8.5781,-2.6884 -16.4051,-4.0321 -23.4416,-4.0321 -9.5661,0 -16.6419,4.2296 -21.188,12.7284 -4.5461,-8.4988 -11.6218,-12.7284 -21.188,-12.7284 -7.0365,0 -14.8634,1.3437 -23.4416,4.0321 -8.6174,2.6879 -15.5746,4.0321 -20.9111,3.9527 -8.42,-0.0789 -16.8006,-0.9487 -25.1412,-2.5693l0 38.9373 72.9723 0c3.7556,-5.2577 9.6851,-7.9063 17.7096,-7.9063 8.0245,0 13.9148,2.6486 17.5911,7.9063l72.9722 0z")
      .attr("fill", "#987654");

    const left_page = book
      .append("path")
      .attr("d","m-91.8281 -63.2483c-3.5577,-6.1667 -9.6455,-9.25 -18.3026,-9.25 -4.8622,0 -10.0802,1.1069 -15.6936,3.3602 -5.613,2.2135 -10.7917,3.3597 -15.5745,3.3597 -4.8622,0 -9.2109,-0.395 -12.9661,-1.1859l-26.8803 25.2597c9.9616,1.9372 18.4207,2.8859 25.3783,2.8859 5.1783,0 11.938,-1.3834 20.3182,-4.1507 8.3807,-2.8064 16.2866,-4.1903 23.7974,-4.1903 8.8149,0 15.1002,2.9647 18.8559,8.9339l1.0673 -25.0225z")
      .attr("fill", "#852369");*/


    const fillingGlass = d3.select("#" + svg_anim_id).select(".animation_book");

    const handleHeight = 2;
    const handle = fillingGlass
      .append("rect")
      .attr("x", wine.attr("x"))
      .attr("y", filled_percentage(0))
      .attr("height", handleHeight)
      .attr("width", wine.attr("width"))
      .attr("fill-opacity", 0)
      .attr("opacity", 0)
      .style("cursor", "grab");
/*

    fillingGlass.on("click", function () {
      let y = d3.mouse(this)[1];
      y = Math.max(maxH, Math.min(y, minH));
      wine
        .transition()
        .ease(customEaseElastic)
        .duration(1000)
        .attr("y", y)
        .attr("height", minH - y + 4); // extra height to compensate for "bounce" during transition
      handle
        .transition()
        .duration(1000)
        .attr("y", y - handleHeight / 2);
      updateText(fillToPercent.invert(y));
    });

    const dragToFill = d3
      .drag()
      .on("start", function () {
        fillingGlass.style("cursor", "grabbing");
        handle.style("cursor", "grabbing");
      })
      .on("drag", function () {
        let y = d3.mouse(this)[1];
        if (firefox)
          y = firefoxY(
            y,
            43.2594 / this.parentNode.getBoundingClientRect().height
          );
        y = Math.max(maxH, Math.min(y, minH));
        handle.attr("y", y - handleHeight / 2);
        wine.attr("height", minH - y).attr("y", y);
        updateText(fillToPercent.invert(y));
      })
      .on("end", function () {
        fillingGlass.style("cursor", "pointer");
        handle.style("cursor", "grab");
      });

    handle.call(dragToFill);
*/



  }
}

const book_size_widget = new BookSizeClass("book_size_widget", "book_size_anim");
